<div class="col-md-8 gn-record">
  <h1>
    <i class="fa gn-icon-{{mdView.current.record.resourceType[0]}}"/>
    {{mdView.current.record.resourceTitle}}
    <span class="text-muted badge"
          data-ng-class="{'text-success': md.mdStatus == 2, 'text-warning': md.mdStatus == 4}"
          data-ng-if="user.isEditorOrMore() && md.mdStatus<50 && isMdWorkflowEnable">{{('mdStatus-' + md.mdStatus) | translate}}</span>
  </h1>



  <div class="gn-margin-bottom"
       data-ng-bind-html="(mdView.current.record.resourceAbstract) | linky | newlines"></div>

  <!-- Display the first metadata status (apply to ISO19139 record) -->
  <div class="row">
    <div data-ng-if="mdView.current.record.cl_status.length > 0"
         data-ng-repeat="c in mdView.current.record.cl_status track by $index">
      <div data-ng-if="showStatusWatermarkFor.indexOf(c.key) === -1
                               && showStatusTopBarFor.indexOf(c.key) === -1"
           title="{{c.key | translate}}"
           class="gn-status gn-status-mdview gn-status-{{c.key}}">
        {{c.key | translate}}
      </div>
    </div>
  </div>

  <div data-ng-if="showCitation"
       data-gn-metadata-citation="mdView.current.record"/>

  <div data-gn-related-observer>
    <!-- TODO: Create a directive to render link in current record directly ?
    or in a list of records ? -->
    <div data-gn-related="mdView.current.record"
         data-user="user"
         data-types="onlines"
         data-has-results="hasRelations.onlines"
         data-title="{{'downloadsAndResources' | translate}}">
    </div>

    <div data-ng-if="mdView.current.record.relatedRecords"
         data-gn-related="mdView.current.record"
         data-user="user"
         data-types="parent|children|brothersAndSisters|services|datasets"
         data-title="{{'associatedResources' | translate}}">
    </div>
  </div>

  <div data-gn-related-observer>
    <div data-gn-related="mdView.current.record"
         data-user="user"
         data-types="fcats|related"
         data-title="{{'featureCatalog' | translate}}">
    </div>
    <div data-ng-if="mdView.current.record.relatedRecords"
         data-gn-related="mdView.current.record"
         data-user="user"
         data-types="siblings|associated"
         data-title="{{'siblings' | translate}}">
    </div>
  </div>


  <div ng-include="'../../catalog/views/default/templates/recordView-common.html'"/>

  <!--<h2 data-translate="">preview</h2>-->
  <!--<div class="gn-map-preview"/>-->

  <h2 data-translate="">technicalInformation</h2>

  <!-- TODOES -->
  <div data-ng-if="mdView.current.record.featureTypes"
       data-ng-repeat="featureType in mdView.current.record.featureTypes">

    <h3><span data-translate="">featureType</span>&nbsp;'{{featureType.typeName}}'</h3>

    <table class="table table-striped" >
      <tbody>
      <tr data-ng-if="featureType.typeName">
        <th data-translate="">featureTypeName</th>
        <td>{{featureType.typeName}}</td>
      </tr>
      <tr data-ng-if="featureType.definition">
        <th data-translate="">featureDefinition</th>
        <td>{{featureType.definition}}</td>
      </tr>
      <tr data-ng-if="featureType.code">
        <th data-translate="">featureCode</th>
        <td>{{featureType.code}}</td>
      </tr>
      <tr data-ng-if="featureType.isAbstract">
        <th data-translate="">featureIsAbstract</th>
        <td>{{featureType.isAbstract}}</td>
      </tr>
      <tr data-ng-if="featureType.aliases">
        <th data-translate="">featureAliases</th>
        <td>{{featureType.aliases}}</td>
      </tr>
      <tr data-ng-if="featureType.attributeTable">
        <th data-translate="">featureAttributeTable</th>
        <td></td>
      </tr>
      <tr data-ng-if="featureType.attributeTable">
        <td colspan="2" class="gn-noborder-top gn-nopadding-top gn-nopadding-bottom"/>
      </tr>
      <tr data-ng-if="featureType.attributeTable">
        <td colspan="2" class="gn-noborder-top gn-table-attribute">
          <div data-ng-if="featureType.attributeTable"
               data-gn-attribute-table-renderer="featureType.attributeTable">
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <table class="table table-striped">
    <tbody>
    <tr data-ng-if="mdView.current.record.cl_maintenanceAndUpdateFrequency.length > 0">
      <th data-translate="">updateFrequency</th>
      <td>
        <p data-ng-repeat="c in mdView.current.record.cl_maintenanceAndUpdateFrequency">
          {{c.default}}
        </p>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.cl_spatialRepresentationType.length > 0">
      <th data-translate="">spatialRepresentationType</th>
      <td>
        <p data-ng-repeat="c in mdView.current.record.cl_spatialRepresentationType">
          {{c.default}}
        </p>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.resolutionScaleDenominator">
      <th data-translate="">scale</th>
      <td>
        <ul>
          <li data-ng-repeat="d in mdView.current.record.resolutionScaleDenominator"
              class="gn-scale">{{d}}
          </li>
        </ul>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.resolutionDistance">
      <th data-translate="">resolution</th>
      <td>
        <ul>
          <li data-ng-repeat="r in mdView.current.record.resolutionDistance">{{r}}</li>
        </ul>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.crsDetails">
      <th data-translate="">crs</th>
      <td>
        <ul>
          <li data-ng-repeat="r in mdView.current.record.crsDetails">
            <a ng-show="r.url" href="{{r.url}}">{{r.name || r.code}}</a>
            <span ng-hide="r.url">{{r.name || r.code}}</span>
          </li>
        </ul>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.format">
      <th data-translate="">format</th>
      <td>
                <span data-ng-repeat="f in mdView.current.record.format track by $index"
                      class="badge">{{f}}</span>
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.lineage">
      <th data-translate="">lineage</th>
      <td>
        <p data-ng-bind-html="mdView.current.record.lineage | linky | newlines"/>
      </td>
    </tr>
    </tbody>
  </table>

  <div data-gn-related-observer>
    <div data-gn-related="mdView.current.record"
         data-user="user"
         data-types="sources"
         data-has-results="hasRelations.sources"
         data-title="{{'sourceDatasets' | translate}}">
    </div>
    <div data-gn-related="mdView.current.record"
         data-user="user"
         data-types="hassources"
         data-has-results="hasRelations.hassources"
         data-title="{{'isSourceOfDatasets' | translate}}">
    </div>
  </div>

  <h2 data-translate="">metadataInformation</h2>

  <a class="btn btn-default gn-margin-bottom"
     data-ng-href="../api/records/{{mdView.current.record.uuid}}/formatters/xml">
    <i class="fa fa-fw fa-file-code-o"/>
    <span data-translate="">metadataInXML</span>
  </a>

  <table class="table table-striped">
    <tbody>
    <tr data-ng-if="mdView.current.record.contact">
      <th data-translate="">contact</th>
      <td>
        <div data-gn-metadata-contacts="mdView.current.record.contact"
             data-gn-mode="org-role" />
      </td>
    </tr>
    <tr data-ng-if="mdView.current.record.mainLanguage">
      <th data-translate="">metadataLanguage</th>
      <td>
        <ul>
          <li>{{mdView.current.record.mainLanguage | translate}}</li>
          <li data-ng-repeat="l in mdView.current.record.otherLanguage">
            {{l | translate}}
          </li>
        </ul>
      </td>
    </tr>
    <tr>
      <th data-translate="">uuid</th>
      <td>{{mdView.current.record.uuid}}</td>
    </tr>
    </tbody>
  </table>
</div>

<div class="col-md-4 gn-md-side">
  <section class="gn-md-side-overview" data-ng-if="mdView.current.record.overview.length > 0">
    <h2>
      <i class="fa fa-fw fa-image"></i>
      <span data-translate="">overview</span>
    </h2>

    <div data-ng-repeat="img in mdView.current.record.overview">
      <img data-gn-img-modal="img"
           class="gn-img-thumbnail img-thumbnail"
           alt="{{img.name}}"
           data-ng-src="{{img.url}}"/>

      <div class="gn-img-thumbnail-caption"
           data-ng-show="img.name">{{img.name}}
      </div>
    </div>
  </section>

  <section class="gn-md-side-extent" data-ng-if="mdView.current.record.geom || mdView.current.record.hasBoundingPolygon">
    <h2>
      <i class="fa fa-fw fa-map-marker"></i>
      <span data-translate="">extent</span>
    </h2>
    <p data-ng-if="mdView.current.record.extentDescription">
    <ul>
      <li data-ng-repeat="d in mdView.current.record.extentDescription">{{d}}</li>
    </ul>
    </p>
    <!-- TODO: use map config -->
    <p data-ng-if="mdView.current.record.geom || mdView.current.record.hasBoundingPolygon">
      <img class="gn-img-thumbnail img-thumbnail gn-img-extent"
           alt="{{'extent' | translate}}"
           aria-label="{{'extent' | translate}}"
           data-ng-src="../api/records/{{mdView.current.record.uuid}}/extents.png"/>
    </p>

  </section>

  <section class="gn-md-side-dates"
           data-ng-if="mdView.current.record.resourceDate.length > 0 ||
                              mdView.current.record.resourceTemporalExtentDateRange ||
                              mdView.current.record.resourceVerticalRange">
    <div data-ng-show="mdView.current.record.resourceDate.length > 0">
      <h2>
        <i class="fa fa-fw fa-clock-o"></i>
        <span data-translate="">resourceEvents</span>
      </h2>

      <ul class="timeline timeline-1-col">
        <li class="timeline-inverted"
            data-ng-repeat="date in mdView.current.record.resourceDate">
          <div class="timeline-badge timeline-badge-small"
               data-ng-class="{'danger': date.type === 'deprecated'}">
            <i class="fa fa-fw"
               data-ng-class="{'fa-chevron-right': date.type === 'creation', 'fa-code-fork': date.type === 'superseded','fa-ban': date.type === 'deprecated', 'fa-retweet': date.type === 'revision', 'fa-check': date.type === 'publication', 'fa-calendar': date.type === 'nextUpdate'}"/>
          </div>
          <div class="timeline-panel">
            <dt data-translate>{{date.type | translate}}</dt>
            <dd data-gn-humanize-time="{{date.date}}"/>
          </div>
        </li>
      </ul>
    </div>

    <div data-ng-show="mdView.current.record.resourceTemporalExtentDetails">
      <h2>
        <i class="fa fa-fw fa-clock-o"></i>
        <span data-translate="">tempExtent</span>
      </h2>


      <div class="flex-row flex-align-center gn-period"
           data-ng-repeat="range in mdView.current.record.resourceTemporalExtentDetails">
        <div class="flex-start"
             data-ng-show="range.start">
          <dt>
            <span data-ng-show="range.start.indeterminatePosition">{{range.start.indeterminatePosition | translate}}&nbsp;</span>
            <span data-gn-humanize-time="{{range.start.date}}"/>
            <span data-ng-show="range.start.calendarEraName">{{range.start.calendarEraName | translate}}</span>

          </dt>
        </div>
        <div class="spacer">
          <i class="fa fa-chevron-right"></i>
        </div>
        <div class="flex-end"
             data-ng-show="range.end">
          <dt>
            <span data-ng-show="range.end.indeterminatePosition">{{range.end.indeterminatePosition | translate}}&nbsp;</span>
            <span data-gn-humanize-time="{{range.end.date}}"/>
            <span data-ng-show="range.end.calendarEraName">{{range.end.calendarEraName | translate}}</span>
          </dt>
        </div>
      </div>
    </div>

    <div data-ng-show="mdView.current.record.resourceVerticalRange">
      <h2>
        <i class="fa fa-fw fa-clock-o"></i>
        <span data-translate="">resourceVerticalRange</span>
      </h2>

      <div class="flex flex-row flex-align-center gn-vertical-range"
           data-ng-repeat="range in mdView.current.record.resourceVerticalRange">
        <div class="width-25">
          <i class="fa fa-fw fa-chevron-up"/>
        </div>
        <div class="width-75">
          <div data-ng-show="range.lte">
            <dt>{{range.lte}}</dt>
          </div>
          <div data-ng-show="range.gte">
            <dt>{{range.gte}}</dt>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="gn-md-side-providedby">
    <h2>
      <i class="fa fa-fw fa-cog"></i>
      <span data-translate="">sourceCatalog</span>
    </h2>
    <div data-gn-record-origin-logo="mdView.current.record"/>
  </section>

  <section class="gn-md-side-calendar">
    <h2>
      <i class="fa fa-fw fa-calendar"></i>
      <span data-translate="">updatedOn</span>
    </h2>
    <p>
              <span data-gn-humanize-time="{{mdView.current.record.changeDate}}"
                    data-from-now=""></span>
    </p>
  </section>

  <div data-gn-more-like-this="mdView.current.record"/>

  <section data-ng-show="isRatingEnabled" class="gn-md-side-rating">
    <h2>
      <i class="fa fa-fw"></i>
      <span data-translate="">rate</span>
    </h2>
    <div data-gn-metadata-rate="mdView.current.record"/>
  </section>


  <div data-gn-userfeedback='mdView.current.record'
       data-gn-user={{user.username}}
       data-ng-if="isUserFeedbackEnabled && mdView.current.record.draft != 'y'">
  </div>
  <div data-gn-md-feedback="mdView.current.record"></div>
  </section>


  <section class="gn-md-side-social" data-ng-show="isSocialbarEnabled">
    <h2>
      <i class="fa fa-fw fa-share-square-o"></i>
      <span data-translate="">shareOn</span>
    </h2>
    <div class="btn-group">
      <a data-ng-href="https://twitter.com/share?url={{socialMediaLink | encodeURIComponent}}"
         title="{{'shareOnTwitter' | translate}}"
         target="_blank"
         class="btn btn-default"><i class="fa fa-fw fa-twitter"></i></a>
      <a
        data-ng-href="https://www.facebook.com/sharer.php?u={{socialMediaLink | encodeURIComponent}}"
        title="{{'shareOnFacebook' | translate}}"
        target="_blank"
        class="btn btn-default"><i class="fa fa-fw fa-facebook"></i></a>
      <a
        data-ng-href="http://www.linkedin.com/shareArticle?mini=true&amp;summary={{mdView.current.record.resourceTitle}}&amp;url={{socialMediaLink | encodeURIComponent}}"
        title="{{'shareOnLinkedIn' | translate}}"
        target="_blank"
        class="btn btn-default"><i class="fa fa-fw fa-linkedin"></i></a>
      <a
        data-ng-href="mailto:?subject={{mdView.current.record.resourceTitle}}&amp;body={{socialMediaLink | encodeURIComponent}}"
        title="{{'shareByEmail' | translate}}"
        target="_blank"
        class="btn btn-default"><i class="fa fa-fw fa-envelope-o"></i></a>
      <a
        data-ng-click="mdService.getPermalink(md)"
        href=""
        title="{{'permalink' | translate}}"
        class="btn btn-default"><i class="fa fa-fw fa-link"></i></a>
    </div>
  </section>


  <div data-ng-show="isRecordHistoryEnabled && user.isEditorOrMore() && mdView.current.record.draft != 'y'"
       data-gn-record-history="mdView.current.record"></div>


  <section class="gn-md-side-errors"
           data-ng-if="mdView.current.record.indexingErrorMsg
                                && user.canEditRecord(mdView.current.record)">
    <h2>
      <i class="fa fa-fw fa-cog"></i>
      <span data-translate="">indexingErrorMessages</span>
    </h2>
    <div class="alert alert-danger">
      <ul>
        <li data-ng-repeat="e in mdView.current.record.indexingErrorMsg">
          <code>
            {{e}}
          </code>
        </li>
      </ul>
    </div>
  </section>
</div>
